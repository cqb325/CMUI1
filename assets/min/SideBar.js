/** ! created at <%= grunt.template.today("yyyy-mm-dd") by cqb %> */
define(["module","react","classnames","core/BaseComponent","utils/shallowEqual","FontIcon","store","internal/EnhancedButton","ReactRouter"],function(a,b,c,d,e,f,g,h,i){"use strict";function j(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function k(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function l(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var m=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),n=b.Component,o=b.PropTypes,p=i.Link,q=function(a){function d(){return j(this,d),k(this,Object.getPrototypeOf(d).apply(this,arguments))}return l(d,a),m(d,[{key:"_onSelect",value:function(a){var b=this.props.data;this.props.onSelect&&this.props.onSelect(b)}},{key:"render",value:function(){var a=this.props.data,d=a.customIcon?b.createElement("i",{className:"menu-icon "+a.customIcon}):a.icon?b.createElement(f,{icon:a.icon,className:"menu-icon"}):null,e=a.link?a.link:null,g=a.text,i=a.children,j=a._visible,k=i?b.createElement(r,{hasExpand:this.props.hasExpand,visible:j,onSelect:this.props.onSelect,items:i,isSub:!0}):"",l=c({active:a._active});return e=e?b.createElement(p,{to:e,"data-identity":this.props.identity,onClick:this._onSelect.bind(this)},b.createElement(h,{initFull:!0},d,g)):b.createElement("a",{href:"javascript:void(0)","data-identity":this.props.identity,onClick:this._onSelect.bind(this)},b.createElement(h,{initFull:!0},d,g)),b.createElement("li",{className:l},e,k)}}]),d}(n),r=function(a){function d(){return j(this,d),k(this,Object.getPrototypeOf(d).apply(this,arguments))}return l(d,a),m(d,[{key:"render",value:function(){var a=[],d=this.props.items,e=this.props.hasExpand;if(d)for(var f=0;f<d.length;f++){var g=d[f],h=g.identity||g.text;a.push(b.createElement(q,{hasExpand:e,onSelect:this.props.onSelect,key:f,identity:h,data:g}))}var i=c({submenu:this.props.isSub}),j=0==e?"block":this.props.visible?"block":"none";return this.props.isSub?b.createElement("ul",{className:i,style:{display:j}},a):b.createElement("ul",{className:i},a)}}]),d}(n),s=function(a){function d(a){j(this,d);var b=k(this,Object.getPrototypeOf(d).call(this,a));return b.data={},b._initActive=null,b._buildData(b.data,-1,a.data),b.addState({data:a.data,_active:b._initActive}),b}return l(d,a),m(d,[{key:"_buildData",value:function(a,b,c){var d=this.props?this.props.prefix+"_":"";c.forEach(function(c){c._parentId=b,a[c.id]=c;var e=g.get(d+"sideBar_active");if(e&&e===c.id){if(c._active=!0,c._visible=!0,this._initActive=c,c._parentId!=-1){var f=this.getItem(c._parentId);f._active=!0,f._visible=!0}this.props.onInitActive&&this.props.onInitActive(c)}c.children&&c.children.length&&this._buildData(a,c.id,c.children)},this)}},{key:"setActive",value:function(a){"string"==typeof a&&(a=this.getItem(id)),this._onSelect(a)}},{key:"setActiveStatus",value:function(a){"string"==typeof a&&(a=this.getItem(a)),this._onSelect(a,!0)}},{key:"clearActive",value:function(){var a=this.props.prefix+"_"||"";g.set(a+"sideBar_active",""),this.setState({_active:null})}},{key:"getItem",value:function(a){return this.data[a]}},{key:"_onSelect",value:function(a,b){var c=this.props.prefix+"_"||"";if(g.set(c+"sideBar_active",a.id),this.state._active&&e(this.state._active,a))a._parentId==-1&&(a._visible=!a._visible,this.setState({_active:a}));else{var d=this.state._active;if(d&&(d._active=!1,d._visible=!1,d._parentId!=-1)){var f=this.getItem(d._parentId);if(e(f,a))return a._active=!0,a._visible=!1,void this.setState({_active:a});f._active=!1,f._visible=!1}if(a._parentId!=-1){var h=this.getItem(a._parentId);h._active=!0,h._visible=!0}a._active=!0,a._visible=!0,this.setState({_active:a})}this.props.onSelect&&!b&&this.props.onSelect(a)}},{key:"render",value:function(){var a=c("cm-sidebar",this.state.theme,this.props.className);return b.createElement("div",null,b.createElement("div",{className:"section client"},b.createElement("div",{className:a,style:this.props.style},b.createElement("div",{className:"sidebar-header"},b.createElement("img",{className:"pull-left",src:this.props.logo}),b.createElement("span",null,this.props.header)),b.createElement(r,{hasExpand:this.props.hasExpand,onSelect:this._onSelect.bind(this),items:this.state.data,isSub:!1}))),b.createElement("div",{className:"desktop-wrap client"},this.props.children))}}]),d}(d);s.propTypes={data:o.array},a.exports=s});