/** ! created at <%= grunt.template.today("yyyy-mm-dd") by cqb %> */
define(["module","react","react-dom","utils/Dom","classnames","core/BaseComponent","FontIcon"],function(a,b,c,d,e,f,g){"use strict";function h(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function i(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function j(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var k=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},l=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),m=function(a){function c(a){h(this,c);var b=i(this,Object.getPrototypeOf(c).call(this,a));return b.addState({current:a.current||0}),b.steps=[],b}return j(c,a),l(c,[{key:"componentWillReceiveProps",value:function(a){a.current!==this.state.current&&this.setState({current:a.current})}},{key:"componentDidMount",value:function(){var a=this,b=1==this.steps.length?"100%":1/(this.steps.length-1)*100+"%",c=this.steps.length>1?this.steps[this.steps.length-1].getWidth():0;this.steps.forEach(function(d,e){e<a.steps.length-1&&d.updateStyle({width:b,marginRight:-c/2+"px"})})}},{key:"bindStep",value:function(a){this.steps.push(a)}},{key:"next",value:function(){return this.state.current==this.steps.length-1?void(this.props.onFinished&&this.props.onFinished()):void(this.state.current<this.steps.length-1&&(this.setState({current:this.state.current+1}),this.props.onChange&&this.props.onChange(this.state.current+1)))}},{key:"prev",value:function(){0!=this.state.current&&this.state.current>0&&(this.setState({current:this.state.current-1}),this.props.onChange&&this.props.onChange(this.state.current-1))}},{key:"setActive",value:function(a){a>0&&a<this.steps.length-1&&a!=this.state.current&&(this.setState({current:a}),this.props.onChange&&this.props.onChange(a))}},{key:"renderSteps",value:function(){var a=this,c=1;return b.Children.map(this.props.children,function(d){var e="";if(d.type)if(d.type.name)e=d.type.name;else{var f=d.type.toString().match(/function\s*([^(]*)\(/);f&&(e=f[1])}if("Step"===e){var g=k({index:c,current:a.state.current,"data-bindStep":a.bindStep.bind(a)},d.props);return c++,b.cloneElement(d,g)}return d})}},{key:"render",value:function(){var a=this.props,c=a.className,d=a.style;c=e("cm-steps",c,{"cm-steps-small":"small"==this.props.size,"cm-steps-vertical":"vertical"==this.props.layout});var f=this.renderSteps();return b.createElement("div",{className:c,style:d},f)}}]),c}(f),n=function(a){function f(a){h(this,f);var b=i(this,Object.getPrototypeOf(f).call(this,a));return b.addState({title:a.title,description:a.description||"",content:a.content,style:{},index:a.index,current:a.current}),b}return j(f,a),l(f,[{key:"componentDidMount",value:function(){this.props["data-bindStep"]&&this.props["data-bindStep"](this)}},{key:"updateStyle",value:function(a){var b=this;window.setTimeout(function(){b.setState({style:a})},0)}},{key:"getWidth",value:function(){var a=c.findDOMNode(this);return Math.ceil(d.dom(a).width())+4}},{key:"componentWillReceiveProps",value:function(a){a.current!==this.state.current&&this.setState({current:a.current})}},{key:"render",value:function(){var a=this.props,c=a.className,d=a.style,f=!1;this.state.current+1>this.state.index&&(f="finished"),this.state.current+1==this.state.index&&(f="process"),c=e("cm-steps-item",{"cm-steps-status-finish":"finished"===f,"cm-steps-status-process":"process"===f}),d=k(this.state.style,d||{});var h="";return h=this.props.icon?b.createElement(g,{icon:this.props.icon}):"finished"==f?b.createElement(g,{icon:"check"}):b.createElement("span",null,this.props.index),b.createElement("div",{className:c,style:d},b.createElement("div",{className:"cm-step-tail"},b.createElement("i",null)),b.createElement("div",{className:"cm-steps-step"},b.createElement("div",{className:"cm-step-head"},b.createElement("div",{className:"cm-step-head-inner"},h)),b.createElement("div",{className:"cm-step-main"},b.createElement("div",{className:"cm-step-title"},this.state.title),b.createElement("div",{className:"cm-step-description"},this.state.description))))}}]),f}(f);m.Step=n,a.exports=m});